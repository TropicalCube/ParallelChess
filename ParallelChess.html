<!DOCTYPE html>

<html>

<head>

<title>Parallel Chess</title>

<style>

.tile {
  padding: 5px;
}

</style>

<script>
    
    turn = "white";

    function changeTurn() {
        if (turn == "white") {
            turn = "black";
        } else {
            turn = "white";
        }
    }

    function selectTile(obj) {

        if (isOccupied(obj)) {
            if (isSelected(obj)) {
                obj.dataset.selected = "no";
                updateTile(obj);
            } else if (! isAnySelected() && obj.dataset.occupant == turn) {
                obj.dataset.selected = "yes";
                updateTile(obj);
            }
            
        } else if (isAnySelected()) {
            if (isLegalMove(getSelected(), obj)) {
                obj.dataset.occupant = getSelected().dataset.occupant;
                getSelected().dataset.occupant = "empty";
                updateTile(obj);
                updateTile(getSelected());
                getSelected().dataset.selected = "no";
            }
        }
    }

    function updateTile(obj) {

        if (isOccupied(obj)) {
            if (obj.dataset.tileColour == "beige") {
                if (obj.dataset.occupant == "white") {
                    if (isSelected(obj)) {
                        obj.src = "beige_white_selected.PNG";
                    } else {
                        obj.src = "beige_white.PNG";
                    }
                } else {
                    if (isSelected(obj)) {
                        obj.src = "beige_black_selected.PNG";
                    } else {
                        obj.src = "beige_black.PNG";
                    }
                }
            } else {
                if (obj.dataset.occupant == "white") {
                    if (isSelected(obj)) {
                        obj.src = "terracotta_white_selected.PNG";
                    } else {
                        obj.src = "terracotta_white.PNG";
                    }
                } else {
                    if (isSelected(obj)) {
                        obj.src = "terracotta_black_selected.PNG";
                    } else {
                        obj.src = "terracotta_black.PNG";
                    }
                }
            }
        } else {
            if (obj.dataset.tileColour == "beige") {
                obj.src = "beige.PNG";
            } else {
                obj.src = "terracotta.PNG";
            }
        }
    }

    function isLegalMove(tile1, tile2) {

        if (tile1.dataset.occupant == "white") {
            if ((parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) + 1) && ((tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 1) || (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 1))) {
                    changeTurn();
                    return true;
                
            } else if (parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) + 2) {
                if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) + 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() + 1)));
                    if (killTile.dataset.occupant == "black") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) + 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() - 1)));
                    if (killTile.dataset.occupant == "black") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else {
                    return false;
                }
            } else {
                return false;
            }
        } else {
            if ((parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) - 1) && ((tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 1) || (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 1))) {
                    changeTurn();
                    return true;
                
            } else if (parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) - 2) {
                if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) - 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() + 1)));
                    if (killTile.dataset.occupant == "white") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) - 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() - 1)));
                    if (killTile.dataset.occupant == "white") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }
    }

    function isOccupied(tile) {

        return tile.dataset.occupant != "empty";

    }

    function isSelected(tile) {

        return tile.dataset.selected == "yes";

    }

    function isAnySelected() {

        return (document.querySelector('[data-selected="yes"]') != null);

    }

    function getSelected() {

        return document.querySelector('[data-selected="yes"]');

    }

    function buildBoard() {

        d1 = document.createElement("DIV");             
        document.body.appendChild(d1);                      
        att = document.createAttribute("class");
        att.value = "row";
        d1.setAttributeNode(att);

        y = 1;
        
        for (m = 0; m < 8; m++) {
            c = document.createElement("DIV");                         
            d1.appendChild(c);                      
            att = document.createAttribute("class");
            att.value = "column";
            c.setAttributeNode(att);
            if (m % 2 == 0) {
                x = 0;
            } else {
                x = 1;
            }
            
            for (n = 0; n < 8; n++) {
                i = document.createElement("IMG");                         
                c.appendChild(i);                      
                att = document.createAttribute("src");
                att1 = document.createAttribute("data-tile-colour");
                att2 = document.createAttribute("data-occupant");
                if (x % 2 == 0) {
                    att.value = "beige.PNG";
                    att1.value = "beige";
                    att2.value = "empty";
                } else if (y < 25) {
                    att.value = "terracotta_white.PNG";
                    att1.value = "terracotta";
                    att2.value = "white";
                } else if (y > 40) {
                    att.value = "terracotta_black.PNG";
                    att1.value = "terracotta";
                    att2.value = "black";
                } else {
                    att.value = "terracotta.PNG";
                    att1.value = "terracotta";
                    att2.value = "empty";
                }
                i.setAttributeNode(att);
                i.setAttributeNode(att1);
                i.setAttributeNode(att2);
                att = document.createAttribute("class");
                att.value = "tile";
                i.setAttributeNode(att);
                att = document.createAttribute("id");
                att.value = ((m + 1).toString()).concat(String.fromCharCode(97 + n));
                i.setAttributeNode(att);
                att = document.createAttribute("data-selected");
                att.value = "no";
                i.setAttributeNode(att);
                att = document.createAttribute("onclick");
                att.value = "selectTile(this)";
                i.setAttributeNode(att);
                x++;
                y++;
            }
        }  
    }

</script>

</head>

<body onload="buildBoard()">

<h1>Parallel Chess</h1>

</body>

</html>
