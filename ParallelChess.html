<!DOCTYPE html>

<html>

<head>

<title>Parallel Chess</title>

<style>

.tile {
  max-width: 5%;
  height: auto;
}

.column {
  display: flex;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
}

.row {
  
  width: 80%;
  margin: 0 auto;
  padding: 20px;
  
  border: 10px solid green;
}

h1 {
  text-align: center;
}

</style>

<script>
    
    imageFolderPath = "images";

    beigeFileName = "beige.PNG";
    brownFileName = "terracotta.PNG";
    brownEligibleFileName = "terracotta_eligible.PNG";
    brownWhiteFileName = "terracotta_white.PNG";
    brownWhiteSelectedFileName = "terracotta_white_selected.PNG";
    brownWhiteEligibleFileName = "terracotta_white_eligible.PNG";
    brownBlackFileName = "terracotta_black.PNG";
    brownBlackSelectedFileName = "terracotta_black_selected.PNG";
    brownBlackEligibleFileName = "terracotta_black_eligible.PNG";

    beigeFilePath = imageFolderPath.concat("/", beigeFileName);
    brownFilePath = imageFolderPath.concat("/", brownFileName);
    brownEligibleFilePath = imageFolderPath.concat("/", brownEligibleFileName);
    brownWhiteFilePath = imageFolderPath.concat("/", brownWhiteFileName);
    brownWhiteSelectedFilePath = imageFolderPath.concat("/", brownWhiteSelectedFileName);
    brownWhiteEligibleFilePath = imageFolderPath.concat("/", brownWhiteEligibleFileName);
    brownBlackFilePath = imageFolderPath.concat("/", brownBlackFileName);
    brownBlackSelectedFilePath = imageFolderPath.concat("/", brownBlackSelectedFileName);
    brownBlackEligibleFilePath = imageFolderPath.concat("/", brownBlackEligibleFileName);

    turn = "white";

    function changeTurn() {
        if (turn == "white") {
            turn = "black";
        } else {
            turn = "white";
        }
    }

    function selectTile(obj) {

        if (isOccupied(obj)) {
            if (isSelected(obj)) {
                obj.dataset.selected = "no";
                updateTile(obj);
            } else if (! isAnySelected() && obj.dataset.occupant == turn) {
                obj.dataset.selected = "yes";
                updateTile(obj);
            }
            
        } else if (isAnySelected()) {
            if (isLegalMove(getSelected(), obj)) {
                obj.dataset.occupant = getSelected().dataset.occupant;
                getSelected().dataset.occupant = "empty";
                updateTile(obj);
                updateTile(getSelected());
                getSelected().dataset.selected = "no";
            }
        }
    }

    function updateTile(obj) {

        if (isOccupied(obj)) {
            if (obj.dataset.occupant == "white") {
                if (isSelected(obj)) {
                    obj.src = brownWhiteSelectedFilePath;
                } else if (isEligible(obj)) {
                    obj.src = brownWhiteEligibleFilePath;
                } else {
                    obj.src = brownWhiteFilePath;
                }
            } else {
                if (isSelected(obj)) {
                    obj.src = brownBlackSelectedFilePath;
                } else if (isEligible(obj)) {
                    obj.src = brownBlackEligibleFilePath;
                } else {
                    obj.src = brownBlackFilePath;
                }
            }
        } else if (isEligible(obj)) {
            obj.src = brownEligibleFilePath;
        } else {
            obj.src = brownFilePath;
        }
    }

    function isLegalMove(tile1, tile2) {

        if (tile1.dataset.occupant == "white") {
            if ((parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) + 1) && ((tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 1) || (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 1))) {
                    changeTurn();
                    return true;
                
            } else if (parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) + 2) {
                if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) + 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() + 1)));
                    if (killTile.dataset.occupant == "black") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) + 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() - 1)));
                    if (killTile.dataset.occupant == "black") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else {
                    return false;
                }
            } else {
                return false;
            }
        } else {
            if ((parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) - 1) && ((tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 1) || (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 1))) {
                    changeTurn();
                    return true;
                
            } else if (parseInt(tile2.id.charAt(0)) == parseInt(tile1.id.charAt(0)) - 2) {
                if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() + 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) - 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() + 1)));
                    if (killTile.dataset.occupant == "white") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else if (tile2.id.charAt(1).charCodeAt() == tile1.id.charAt(1).charCodeAt() - 2) {
                    killTile = document.getElementById(((parseInt(tile1.id.charAt(0)) - 1).toString()).concat(String.fromCharCode(tile1.id.charAt(1).charCodeAt() - 1)));
                    if (killTile.dataset.occupant == "white") {
                        killTile.dataset.occupant = "empty";
                        updateTile(killTile);
                        return true;
                    } else {
                        return false;
                    }
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }
    }

    function isOccupied(tile) {
        return tile.dataset.occupant != "empty";
    }

    function isSelected(tile) {
        return tile.dataset.selected == "yes";
    }

    function isAnySelected() {
        return (document.querySelector('[data-selected="yes"]') != null);
    }

    function getSelected() {
        return document.querySelector('[data-selected="yes"]');
    }

    function isEligible(tile) {
        return tile.dataset.eligible == "yes";
    }

    function buildBoard() {

        d1 = document.createElement("DIV");             
        document.body.appendChild(d1);                      
        att = document.createAttribute("class");
        att.value = "row";
        d1.setAttributeNode(att);

        y = 1;
        
        for (m = 0; m < 8; m++) {
            c = document.createElement("DIV");                         
            d1.appendChild(c);                      
            att = document.createAttribute("class");
            att.value = "column";
            c.setAttributeNode(att);
            if (m % 2 == 0) {
                x = 0;
            } else {
                x = 1;
            }
            
            for (n = 0; n < 8; n++) {
                i = document.createElement("IMG");                         
                c.appendChild(i);                      
                att = document.createAttribute("src");
                att1 = document.createAttribute("data-tile-colour");
                att2 = document.createAttribute("data-occupant");
                if (x % 2 == 0) {
                    att.value = beigeFilePath;
                    att1.value = "beige";
                    att2.value = "empty";
                } else if (y < 25) {
                    att.value = brownWhiteFilePath;
                    att1.value = "brown";
                    att2.value = "white";
                } else if (y > 40) {
                    att.value = brownBlackFilePath;
                    att1.value = "brown";
                    att2.value = "black";
                } else {
                    att.value = brownFilePath;
                    att1.value = "brown";
                    att2.value = "empty";
                }
                i.setAttributeNode(att);
                i.setAttributeNode(att1);
                i.setAttributeNode(att2);
                att = document.createAttribute("class");
                att.value = "tile";
                i.setAttributeNode(att);
                att = document.createAttribute("id");
                att.value = ((m + 1).toString()).concat(String.fromCharCode(97 + n));
                i.setAttributeNode(att);
                att = document.createAttribute("data-eligible");
                att.value = "no";
                i.setAttributeNode(att);
                att = document.createAttribute("data-selected");
                att.value = "no";
                i.setAttributeNode(att);
                att = document.createAttribute("onclick");
                att.value = "selectTile(this)";
                i.setAttributeNode(att);
                x++;
                y++;
            }
        }  
    }

</script>

</head>

<body onload="buildBoard()">

<h1>Parallel Chess</h1>

</body>

</html>
